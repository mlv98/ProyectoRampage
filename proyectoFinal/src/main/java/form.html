<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head('Configurar Perfil')">
  <!-- Asegúrate de tener Tailwind cargado en tu head -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.2/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-700 text-gray-100 antialiased">

  <!-- HEADER -->
  <div th:replace="fragments/header :: header"></div>

  <!-- CONTENEDOR PRINCIPAL -->
  <main class="min-h-screen flex items-center justify-center py-16 px-4">
    <div class="w-full max-w-lg bg-gray-800 bg-opacity-60 backdrop-blur-lg rounded-2xl shadow-xl p-8 space-y-6">

      <h1 class="text-3xl font-extrabold text-center text-accent">Perfil</h1>

      <div th:if="${success}" class="bg-green-500 bg-opacity-20 border border-green-400 text-green-200 p-4 rounded">
        [[${success}]]
      </div>

      <form th:action="@{/profile}" method="post"
            th:object="${profileForm}" enctype="multipart/form-data"
            class="space-y-5">

        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

        <!-- Avatar actual -->
        <div class="flex flex-col items-center">
          <label class="mb-2 font-medium">Avatar actual:</label>
          <img
            th:src="${user.avatarUrl != null} ? @{${user.avatarUrl}} : @{/images/default-avatar.png}"
            alt="Avatar" class="w-24 h-24 rounded-full object-cover border-2 border-accent" />
        </div>

        <!-- Subir nuevo avatar -->
        <div>
          <label for="avatarFile" class="block mb-1 font-medium">Subir nuevo avatar</label>
          <input type="file" id="avatarFile" name="avatarFile"
                 class="w-full text-sm text-gray-300 file:bg-gray-700 file:border-0
                        file:py-2 file:px-4 file:rounded file:bg-opacity-50
                        hover:file:bg-opacity-80 transition" />
        </div>

        <!-- Nombre y Apellido en dos columnas -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="nombre" class="block mb-1 font-medium">Nombre</label>
            <input type="text" id="nombre" th:field="*{nombre}"
                   class="w-full bg-gray-700 bg-opacity-40 border border-gray-600
                          p-2 rounded focus:outline-none focus:ring-2 focus:ring-accent" />
            <p th:if="${#fields.hasErrors('nombre')}"
               class="text-red-500 text-sm mt-1">[[${#fields.error('nombre')}]]</p>
          </div>
          <div>
            <label for="apellido" class="block mb-1 font-medium">Apellido</label>
            <input type="text" id="apellido" th:field="*{apellido}"
                   class="w-full bg-gray-700 bg-opacity-40 border border-gray-600
                          p-2 rounded focus:outline-none focus:ring-2 focus:ring-accent" />
            <p th:if="${#fields.hasErrors('apellido')}"
               class="text-red-500 text-sm mt-1">[[${#fields.error('apellido')}]]</p>
          </div>
        </div>

        <!-- Email -->
        <div>
          <label for="email" class="block mb-1 font-medium">Email</label>
          <input type="email" id="email" th:field="*{email}"
                 class="w-full bg-gray-700 bg-opacity-40 border border-gray-600
                        p-2 rounded focus:outline-none focus:ring-2 focus:ring-accent" />
          <p th:if="${#fields.hasErrors('email')}"
             class="text-red-500 text-sm mt-1">[[${#fields.error('email')}]]</p>
        </div>

        <!-- Contraseñas -->
        <div class="space-y-4">
          <div>
            <label for="currentPassword" class="block mb-1 font-medium">Contraseña actual</label>
            <input type="password" id="currentPassword" th:field="*{currentPassword}"
                   class="w-full bg-gray-700 bg-opacity-40 border border-gray-600
                          p-2 rounded focus:outline-none focus:ring-2 focus:ring-accent" />
            <p th:if="${#fields.hasErrors('currentPassword')}"
               class="text-red-500 text-sm mt-1">[[${#fields.error('currentPassword')}]]</p>
          </div>
          <div>
            <label for="newPassword" class="block mb-1 font-medium">Nueva contraseña</label>
            <input type="password" id="newPassword" th:field="*{newPassword}"
                   class="w-full bg-gray-700 bg-opacity-40 border border-gray-600
                          p-2 rounded focus:outline-none focus:ring-2 focus:ring-accent" />
            <p th:if="${#fields.hasErrors('newPassword')}"
               class="text-red-500 text-sm mt-1">[[${#fields.error('newPassword')}]]</p>
          </div>
        </div>

        <!-- Botones -->
        <div class="flex items-center justify-between pt-4 border-t border-gray-600">
          <button type="submit"
                  class="bg-blue-600 hover:bg-blue-700 text-white font-semibold
                         px-6 py-2 rounded-lg transition">
            Guardar cambios
          </button>
          <a th:href="@{/}" class="text-gray-400 hover:underline">Cancelar</a>
        </div>

      </form>
    </div>
  </main>

  <!-- FOOTER -->
  <div th:replace="fragments/footer :: footer"></div>

  <!-- Scripts -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script th:src="@{/js/games-carousel.js}" defer></script>
  <script th:src="@{/js/games.js}" defer></script>

</body>
</html>
