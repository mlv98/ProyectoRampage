<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Compatibilidad PC</title>
<!-- Hoja de estilo externa -->
<!-- CDN (para producción, instala con PostCSS o CLI) -->
<script src="https://cdn.tailwindcss.com"></script>
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.css"
	rel="stylesheet" />
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

<link th:href="@{/css/home.css}" rel="stylesheet" />
<link rel="stylesheet" th:href="@{/css/compatibility.css}" />
</head>

<body class="text-gray-100 antialiased"
	style="background: linear-gradient(135deg, #000000 0%, #1a1a1a 40%, #333333 100%);">
	
	<!-- Header correctamente estructurado -->
	<div th:replace="fragments/header :: header"></div>
	<div style="height:6rem;"></div>
	
	<h1 class="text-6xl font-bold text-center mb-8" data-aos="fade-down">Verificar
		compatibilidad</h1>
	<main class="form-container">
		<!-- Título centrado que empuja el contenido -->


		<!-- Panel izquierdo: circuitos y formulario -->
		<div class="left-panel">

			<form th:action="@{/compatibility/check}" th:object="${form}"
				method="post" class="compat-form">
				<input type="hidden" th:name="${_csrf.parameterName}"
					th:value="${_csrf.token}" />

				<div class="field">
					<label for="gameName"><i
						class="fa-solid fa-gamepad field-icon"></i> Juego</label> <input
						type="text" id="gameName" th:field="*{gameSlug}"
						placeholder="Escribe para buscar…" required />
					<div id="gameSuggestions" class="suggestions"></div>
				</div>

				<div class="field">
					<label for="cpuName"><i
						class="fa-solid fa-microchip field-icon"></i> CPU</label> <input
						type="text" id="cpuName" placeholder="Escribe para buscar CPU…"
						required /> <input type="hidden" id="cpuId" th:field="*{cpuId}" />
					<div id="cpuSuggestions" class="suggestions"></div>
				</div>

				<div class="field">
					<label for="gpuName"><i
						class="fa-solid fa-microchip field-icon"></i> GPU</label> <input
						type="text" id="gpuName" placeholder="Escribe para buscar GPU…"
						required /> <input type="hidden" id="gpuId" th:field="*{gpuId}" />
					<div id="gpuSuggestions" class="suggestions"></div>
				</div>

				<div class="field">
					<label for="ramSelect"><i
						class="fa-solid fa-memory field-icon"></i> RAM (GB)</label> <select
						id="ramSelect" th:field="*{ram}">
						<option value="" disabled selected hidden>-- Elige RAM --</option>
						<option value="2">2</option>
						<option value="4">4</option>
						<option value="8">8</option>
						<option value="16">16</option>
						<option value="32">32</option>
						<option value="64">64</option>
					</select>
				</div>

				<div class="field">
					<label for="storage"><i class="fa-solid fa-hdd field-icon"></i>
						Almacenamiento (GB)</label> <input type="number" id="storage"
						th:field="*{storage}" min="1" required />
				</div>

				<button type="submit" class="btn-submit">Comprobar
					compatibilidad</button>
			</form>
		</div>

		<!-- Panel derecho: loader, requisitos y resultados -->
		<div class="right-panel">
			<div id="loadingOverlay" class="loader">
				<div class="spinner"></div>
				<p>Analizando compatibilidad...</p>
			</div>

			<section th:if="${requirements != null}" class="requirements">
				<h2>Requisitos mínimos</h2>
				<p th:text="${requirements.platforms[0]?.requirements?.minimum}">Mínimos
					no disponibles</p>
				<h2>Requisitos recomendados</h2>
				<p th:text="${requirements.platforms[0]?.requirements?.recommended}">Recomendados
					no disponibles</p>
			</section>

			<section th:if="${result != null}" class="result">
				<h2>Compatibilidad</h2>
				<h2 th:text="${result.message}">Mensaje</h2>

				<ul class="issues" th:if="${result.issues}">
					<li th:each="issue : ${result.issues}" th:text="${issue}"></li>
				</ul>
				<div class="logs" th:if="${result.cpuLog}">
					<h2>Detalles de la comparación de CPU</h2>
					<pre th:text="${result.cpuLog}"></pre>
				</div>
				<div class="logs" th:if="${result.gpuLog}">
					<h2>Detalles de la comparación de GPU</h2>
					<pre th:text="${result.gpuLog}"></pre>
				</div>
			</section>
		</div>
	</main>
	<div th:replace="fragments/footer :: footer"></div>


	<!-- 3) Librería Chart.js -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<!-- 4) Tu script de compatibilidad -->
	<script th:src="@{/js/compatibility.js}"></script>
	<script src="https://unpkg.com/aos@2.3.1/dist/aos.js" defer></script>
	<!-- Flowbite JS: necesario para dropdowns, tooltips, etc. -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js"></script>
	
</body>
</html>